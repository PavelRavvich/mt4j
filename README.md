# MT4J

![Build](https://github.com/triodjangopiter/bridge/workflows/Build/badge.svg)
![codecov](https://codecov.io/gh/triodjangopiter/bridge/branch/master/graph/badge.svg?token=Y3IRTX7LPW)


##About
MT4J is integration bridge between Meta Trader 5 and Java implemented through sync http requests.

Using this app you can write trading strategies with Java instead of mql5 language. For implementation strategy logic you can 
use already connected [ta4j] technical indicators library, or connect something else what you prefer using another maven artifact with `pom.xml` dependencies.

The local server based on Tomcat and use port **80**. Port can't be changed by specific Meta Trader 5 reason, see more in MQL5 documentation: [https://www.mql5.com/en/docs/network/webrequest][webrequest].

MetaTrader 5 required permission in settings for send http requests to localhost, see more in MQL5 documentation: [https://www.mql5.com/en/docs/network][settings]

##Data Exchange Protocol

Endpoints:

**POST** `http://127.0.0.1/api/advisor/add` - save advisor and return UUID identifier.

_Request:_
```json
{
    "magic": 100000,
    "inputs": [
        {
            "key": "propName1",
            "value": "str",
            "type": "STRING"
        },
        {
            "key": "propName2",
            "value": 10,
            "type": "NUMBER"
        }
    ]
}
```

_Response:_
```json
{
    "id": "c4eb34e4-c9c3-4b7e-856d-d5d00588464d",
    "magic": 100000,
    "inputs": [
        {
            "key": "propName1",
            "value": "str",
            "type": "STRING"
        },
        {
            "key": "propName2",
            "value": "10:00",
            "type": "TIME"
        },
        {
            "key": "propName3",
            "value": 10,
            "type": "NUMBER"
        }
    ]
}
```


**GET** `http://127.0.0.1/api/signal` - resolve indicator's data and actual state of open and closed positions, return signal generated by wired strategy.

_Request:_
```json
{
    "advisorId":"6a649280-2d72-4f4c-8457-0b0f9c43f244",
    "strategyName":"EXAMPLE",
    "positions":[
        {
            "isHistory": true,
            "type": "BUY | SELL",
            "magic": 100000,
            "positionId": 100000,
            "lot": 0.01,
            "stopLoss": 100,
            "takeProfit": 100,
            "openAt": 16384394738,
            "closeAt": 16384394738,
            "profit": 123.45
        }
    ],
    "rates": {
        "M_1": [
            {
                "spread": 4,
                "time": 16384394738,
                "open": 1.12412,
                "high": 1.32412,
                "low": 1.32421,
                "close": 1.32111,
                "tickVolume": 12,
                "realVolume": 0
            }
        ]
    }
}
```

_Response variations:_

###### Open Position Signal Response:
```json
{
    "advisorId": "c4eb34e4-c9c3-4b7e-856d-d5d00588464d",
    "type": "BUY | SELL",
    "lot": 0.01,
    "stopLoss": 100,
    "takeProfit": 100
}
```
###### Update Position Signal Response:
```json
{
    "advisorId": "c4eb34e4-c9c3-4b7e-856d-d5d00588464d",
    "type": "UPDATE",
    "positionId": 10000000,
    "lot": 0.01,
    "stopLoss": 100,
    "takeProfit": 100
}
```
###### Close Position Signal Response:
```json
{
    "advisorId": "c4eb34e4-c9c3-4b7e-856d-d5d00588464d",
    "type": "CLOSE",
    "positionId": 1000000000
}
```
###### No Action Signal Response:
```json
{
    "advisorId": "c4eb34e4-c9c3-4b7e-856d-d5d00588464d",
    "type": "NO_ACTION"
}
```


**Contribution**

    1. For bug reports welcome to GitHub Issue.
    2. Pull Request should be supported GitHub Issue.
    


[webrequest]: https://www.mql5.com/en/docs/network/webrequest
[settings]:https://www.mql5.com/en/docs/network
[ta4j]:https://github.com/ta4j